<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Visualize Genome Coverage with Various Annotations • ggcoverage</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Visualize Genome Coverage with Various Annotations">
<meta property="og:description" content="The goal of ggcoverage is to simplify the process of visualizing genome coverage. It contains functions to 
    load data from BAM, BigWig or BedGraph files, create genome coverage plot, add various annotations to 
    the coverage plot, including base and amino acid annotation, GC annotation, gene annotation, transcript annotation, ideogram annotation and peak annotation.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">ggcoverage</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.7.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/ggcoverage.html">Get started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="ggcoverage---visualize-and-annotate-genome-coverage-with-ggplot2" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#ggcoverage---visualize-and-annotate-genome-coverage-with-ggplot2" class="anchor"></a>ggcoverage - Visualize and annotate genome coverage with ggplot2</h1></div>
<p><img src="reference/figures/ggcoverage.png" align="right" width="200"></p>
<p><a href="https://cran.r-project.org/package=ggcoverage"><img src="https://www.r-pkg.org/badges/version/ggcoverage?color=orange" alt="CRAN"></a> <img src="https://img.shields.io/badge/license-MIT-green" alt="License"><a href="https://github.com/showteeth/ggcoverage"><img src="https://img.shields.io/github/languages/code-size/showteeth/ggcoverage.svg" alt="CODE_SIZE"></a></p>
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The goal of <code>ggcoverage</code> is simplify the process of visualizing genome coverage. It contains three main parts:</p>
<ul>
<li>
<strong>Load the data</strong>: <code>ggcoverage</code> can load BAM, BigWig (.bw), BedGraph files from various NGS data, including WGS, RNA-seq, ChIP-seq, ATAC-seq, et al.</li>
<li><strong>Create genome coverage plot</strong></li>
<li>
<strong>Add annotations</strong>: <code>ggcoverage</code> supports six different annotations:
<ul>
<li>
<strong>base and amino acid annotation</strong>: Visualize genome coverage at single-nucleotide level with bases and amino acids.</li>
<li>
<strong>GC annotation</strong>: Visualize genome coverage with GC content</li>
<li>
<strong>gene annotation</strong>: Visualize genome coverage across whole gene</li>
<li>
<strong>transcription annotation</strong>: Visualize genome coverage across different transcripts</li>
<li>
<strong>ideogram annotation</strong>: Visualize the region showing on whole chromosome</li>
<li>
<strong>peak annotation</strong>: Visualize genome coverage and peak identified</li>
</ul>
</li>
</ul>
<p><code>ggcoverage</code> utilizes <code>ggplot2</code> plotting system, so its usage is <strong>ggplot2-style</strong>!</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><code>ggcoverage</code> is an R package distributed as part of the <a href="https://cran.r-project.org/">CRAN</a>. To install the package, start R and enter:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># install via CRAN</span>
<span class="fu">install.package</span><span class="op">(</span><span class="st">"ggcoverage"</span><span class="op">)</span>

<span class="co"># install via Github</span>
<span class="co"># install.package("remotes")   #In case you have not installed it.</span>
<span class="fu">remotes</span><span class="fu">::</span><span class="fu"><a href="https://remotes.r-lib.org/reference/install_github.html">install_github</a></span><span class="op">(</span><span class="st">"showteeth/ggcoverage"</span><span class="op">)</span></code></pre></div>
<p>In general, it is <strong>recommended</strong> to install from <a href="https://github.com/showteeth/ggcoverage">Github repository</a> (update more timely).</p>
<p>Once <code>ggcoverage</code> is installed, it can be loaded by the following command.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"rtracklayer"</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"ggcoverage"</span><span class="op">)</span></code></pre></div>
</div>
<div id="rna-seq-data" class="section level2">
<h2 class="hasAnchor">
<a href="#rna-seq-data" class="anchor"></a>RNA-seq data</h2>
<div id="load-the-data" class="section level3">
<h3 class="hasAnchor">
<a href="#load-the-data" class="anchor"></a>Load the data</h3>
<p>The RNA-seq data used here are from <a href="https://bioconductor.org/packages/release/data/experiment/html/RNAseqData.HNRNPC.bam.chr14.html">Transcription profiling by high throughput sequencing of HNRNPC knockdown and control HeLa cells</a>, we select four sample to use as example: ERR127307_chr14, ERR127306_chr14, ERR127303_chr14, ERR127302_chr14, and all bam files are converted to bigwig file with <a href="https://deeptools.readthedocs.io/en/develop/">deeptools</a>.</p>
<p>Load metadata:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load metadata</span>
<span class="va">meta.file</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"RNA-seq"</span>, <span class="st">"meta_info.csv"</span>, package <span class="op">=</span> <span class="st">"ggcoverage"</span><span class="op">)</span>
<span class="va">sample.meta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.csv</a></span><span class="op">(</span><span class="va">meta.file</span><span class="op">)</span>
<span class="va">sample.meta</span>
<span class="co">#&gt;        SampleName    Type Group</span>
<span class="co">#&gt; 1 ERR127302_chr14 KO_rep1    KO</span>
<span class="co">#&gt; 2 ERR127303_chr14 KO_rep2    KO</span>
<span class="co">#&gt; 3 ERR127306_chr14 WT_rep1    WT</span>
<span class="co">#&gt; 4 ERR127307_chr14 WT_rep2    WT</span></code></pre></div>
<p>Load track files:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># track folder</span>
<span class="va">track.folder</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"RNA-seq"</span>, package <span class="op">=</span> <span class="st">"ggcoverage"</span><span class="op">)</span>
<span class="co"># load bigwig file</span>
<span class="va">track.df</span> <span class="op">=</span> <span class="fu"><a href="reference/LoadTrackFile.html">LoadTrackFile</a></span><span class="op">(</span>track.folder <span class="op">=</span> <span class="va">track.folder</span>, format <span class="op">=</span> <span class="st">"bw"</span>,
                         meta.info <span class="op">=</span> <span class="va">sample.meta</span><span class="op">)</span>
<span class="co"># check data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">track.df</span><span class="op">)</span>
<span class="co">#&gt;   seqnames    start      end score    Type Group</span>
<span class="co">#&gt; 1    chr14 21572751 21630650     0 KO_rep1    KO</span>
<span class="co">#&gt; 2    chr14 21630651 21630700     1 KO_rep1    KO</span>
<span class="co">#&gt; 3    chr14 21630701 21630800     4 KO_rep1    KO</span>
<span class="co">#&gt; 4    chr14 21630801 21657350     0 KO_rep1    KO</span>
<span class="co">#&gt; 5    chr14 21657351 21657450     1 KO_rep1    KO</span>
<span class="co">#&gt; 6    chr14 21657451 21663550     0 KO_rep1    KO</span></code></pre></div>
<p>Prepare mark region:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create mark region</span>
<span class="va">mark.region</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">21678900</span>,<span class="fl">21732001</span>,<span class="fl">21737590</span><span class="op">)</span>,
                       end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">21679900</span>,<span class="fl">21732400</span>,<span class="fl">21737650</span><span class="op">)</span>,
                       label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"M1"</span>, <span class="st">"M2"</span>, <span class="st">"M3"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># check data</span>
<span class="va">mark.region</span>
<span class="co">#&gt;      start      end label</span>
<span class="co">#&gt; 1 21678900 21679900    M1</span>
<span class="co">#&gt; 2 21732001 21732400    M2</span>
<span class="co">#&gt; 3 21737590 21737650    M3</span></code></pre></div>
<p>Load GTF file:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">gtf.file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"used_hg19.gtf"</span>, package <span class="op">=</span> <span class="st">"ggcoverage"</span><span class="op">)</span>
<span class="va">gtf.gr</span> <span class="op">=</span> <span class="fu">rtracklayer</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/rtracklayer/man/GFFFile-class.html">import.gff</a></span><span class="op">(</span>con <span class="op">=</span> <span class="va">gtf.file</span>, format <span class="op">=</span> <span class="st">'gtf'</span><span class="op">)</span></code></pre></div>
</div>
<div id="basic-coverage" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-coverage" class="anchor"></a>Basic coverage</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">basic.coverage</span> <span class="op">=</span> <span class="fu"><a href="reference/ggcoverage.html">ggcoverage</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">track.df</span>, color <span class="op">=</span> <span class="st">"auto"</span>, 
                            mark.region <span class="op">=</span> <span class="va">mark.region</span>, range.position <span class="op">=</span> <span class="st">"out"</span><span class="op">)</span>
<span class="va">basic.coverage</span></code></pre></div>
<p><img src="reference/figures/README-basic_coverage-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>You can also change Y axis style:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">basic.coverage</span> <span class="op">=</span> <span class="fu"><a href="reference/ggcoverage.html">ggcoverage</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">track.df</span>, color <span class="op">=</span> <span class="st">"auto"</span>, 
                            mark.region <span class="op">=</span> <span class="va">mark.region</span>, range.position <span class="op">=</span> <span class="st">"in"</span><span class="op">)</span>
<span class="va">basic.coverage</span></code></pre></div>
<p><img src="reference/figures/README-basic_coverage_2-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="add-gene-annotation" class="section level3">
<h3 class="hasAnchor">
<a href="#add-gene-annotation" class="anchor"></a>Add gene annotation</h3>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">basic.coverage</span> <span class="op">+</span> 
  <span class="fu"><a href="reference/geom_gene.html">geom_gene</a></span><span class="op">(</span>gtf.gr<span class="op">=</span><span class="va">gtf.gr</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-gene_coverage-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="add-transcript-annotation" class="section level3">
<h3 class="hasAnchor">
<a href="#add-transcript-annotation" class="anchor"></a>Add transcript annotation</h3>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">basic.coverage</span> <span class="op">+</span> 
  <span class="fu"><a href="reference/geom_transcript.html">geom_transcript</a></span><span class="op">(</span>gtf.gr<span class="op">=</span><span class="va">gtf.gr</span>,label.vjust <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-transcript_coverage-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="add-ideogram" class="section level3">
<h3 class="hasAnchor">
<a href="#add-ideogram" class="anchor"></a>Add ideogram</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">basic.coverage</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_gene.html">geom_gene</a></span><span class="op">(</span>gtf.gr<span class="op">=</span><span class="va">gtf.gr</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_ideogram.html">geom_ideogram</a></span><span class="op">(</span>genome <span class="op">=</span> <span class="st">"hg19"</span>,plot.space <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Loading ideogram...</span>
<span class="co">#&gt; Loading ranges...</span>
<span class="co">#&gt; Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="co">#&gt; replace the existing scale.</span></code></pre></div>
<p><img src="reference/figures/README-ideogram_coverage_1-1.png" width="100%" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">basic.coverage</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_transcript.html">geom_transcript</a></span><span class="op">(</span>gtf.gr<span class="op">=</span><span class="va">gtf.gr</span>,label.vjust <span class="op">=</span> <span class="fl">1.5</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_ideogram.html">geom_ideogram</a></span><span class="op">(</span>genome <span class="op">=</span> <span class="st">"hg19"</span>,plot.space <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Loading ideogram...</span>
<span class="co">#&gt; Loading ranges...</span>
<span class="co">#&gt; Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="co">#&gt; replace the existing scale.</span></code></pre></div>
<p><img src="reference/figures/README-ideogram_coverage_2-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="dna-seq-data" class="section level2">
<h2 class="hasAnchor">
<a href="#dna-seq-data" class="anchor"></a>DNA-seq data</h2>
<div id="cnv" class="section level3">
<h3 class="hasAnchor">
<a href="#cnv" class="anchor"></a>CNV</h3>
<div id="load-the-data-1" class="section level4">
<h4 class="hasAnchor">
<a href="#load-the-data-1" class="anchor"></a>Load the data</h4>
<p>The DNA-seq data used here are from <a href="http://bioconductor.org/help/course-materials/2014/SeattleOct2014/B02.2.3_CopyNumber.html">Copy number work flow</a>, we select tumor sample, and get bin counts with <code><a href="https://rdrr.io/pkg/cn.mops/man/getReadCountsFromBAM.html">cn.mops::getReadCountsFromBAM</a></code> with <code>WL</code> 1000.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># track file</span>
<span class="va">track.file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"DNA-seq"</span>, <span class="st">"CNV_example.txt"</span>, package <span class="op">=</span> <span class="st">"ggcoverage"</span><span class="op">)</span>
<span class="va">track.df</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/utils/read.table.html">read.table</a></span><span class="op">(</span><span class="va">track.file</span>, header <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co"># check data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">track.df</span><span class="op">)</span>
<span class="co">#&gt;   seqnames    start      end score  Type Group</span>
<span class="co">#&gt; 1     chr4 61743001 61744000    17 tumor tumor</span>
<span class="co">#&gt; 2     chr4 61744001 61745000    14 tumor tumor</span>
<span class="co">#&gt; 3     chr4 61745001 61746000    13 tumor tumor</span>
<span class="co">#&gt; 4     chr4 61746001 61747000    16 tumor tumor</span>
<span class="co">#&gt; 5     chr4 61747001 61748000    25 tumor tumor</span>
<span class="co">#&gt; 6     chr4 61748001 61749000    24 tumor tumor</span></code></pre></div>
</div>
<div id="basic-coverage-1" class="section level4">
<h4 class="hasAnchor">
<a href="#basic-coverage-1" class="anchor"></a>Basic coverage</h4>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">basic.coverage</span> <span class="op">=</span> <span class="fu"><a href="reference/ggcoverage.html">ggcoverage</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">track.df</span>,color <span class="op">=</span> <span class="cn">NULL</span>, mark.region <span class="op">=</span> <span class="cn">NULL</span>,
                            region <span class="op">=</span> <span class="st">'chr4:61750000-62,700,000'</span>, range.position <span class="op">=</span> <span class="st">"out"</span><span class="op">)</span>
<span class="va">basic.coverage</span></code></pre></div>
<p><img src="reference/figures/README-basic_coverage_dna-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="add-gc-annotations" class="section level4">
<h4 class="hasAnchor">
<a href="#add-gc-annotations" class="anchor"></a>Add GC annotations</h4>
<p>Add <strong>GC</strong>, <strong>ideogram</strong> and <strong>gene</strong> annotaions.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load genome data</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="st">"BSgenome.Hsapiens.UCSC.hg19"</span><span class="op">)</span>
<span class="co">#&gt; Loading required package: BSgenome</span>
<span class="co">#&gt; Loading required package: Biostrings</span>
<span class="co">#&gt; Loading required package: XVector</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Attaching package: 'Biostrings'</span>
<span class="co">#&gt; The following object is masked from 'package:base':</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;     strsplit</span>
<span class="co"># create plot</span>
<span class="va">basic.coverage</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_gc.html">geom_gc</a></span><span class="op">(</span>bs.fa.seq<span class="op">=</span><span class="va">BSgenome.Hsapiens.UCSC.hg19</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_gene.html">geom_gene</a></span><span class="op">(</span>gtf.gr<span class="op">=</span><span class="va">gtf.gr</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_ideogram.html">geom_ideogram</a></span><span class="op">(</span>genome <span class="op">=</span> <span class="st">"hg19"</span><span class="op">)</span>
<span class="co">#&gt; Loading ideogram...</span>
<span class="co">#&gt; Loading ranges...</span>
<span class="co">#&gt; Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="co">#&gt; replace the existing scale.</span></code></pre></div>
<p><img src="reference/figures/README-gc_coverage-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="single-nucleotide-level" class="section level3">
<h3 class="hasAnchor">
<a href="#single-nucleotide-level" class="anchor"></a>Single-nucleotide level</h3>
<div id="load-the-data-2" class="section level4">
<h4 class="hasAnchor">
<a href="#load-the-data-2" class="anchor"></a>Load the data</h4>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># prepare sample metadata</span>
<span class="va">sample.meta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>
  SampleName <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tumorA.chr4.selected"</span><span class="op">)</span>,
  Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tumorA"</span><span class="op">)</span>,
  Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"tumorA"</span><span class="op">)</span>
<span class="op">)</span>
<span class="co"># load bam file</span>
<span class="va">bam.file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"DNA-seq"</span>, <span class="st">"tumorA.chr4.selected.bam"</span>, package <span class="op">=</span> <span class="st">"ggcoverage"</span><span class="op">)</span>
<span class="va">track.df</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/LoadTrackFile.html">LoadTrackFile</a></span><span class="op">(</span>
  track.file <span class="op">=</span> <span class="va">bam.file</span>,
  meta.info <span class="op">=</span> <span class="va">sample.meta</span>,
  single.nuc<span class="op">=</span><span class="cn">TRUE</span>, single.nuc.region<span class="op">=</span><span class="st">"chr4:62474235-62474295"</span>
<span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">track.df</span><span class="op">)</span>
<span class="co">#&gt;   seqnames    start      end score   Type  Group</span>
<span class="co">#&gt; 1     chr4 62474235 62474236     5 tumorA tumorA</span>
<span class="co">#&gt; 2     chr4 62474236 62474237     5 tumorA tumorA</span>
<span class="co">#&gt; 3     chr4 62474237 62474238     5 tumorA tumorA</span>
<span class="co">#&gt; 4     chr4 62474238 62474239     6 tumorA tumorA</span>
<span class="co">#&gt; 5     chr4 62474239 62474240     6 tumorA tumorA</span>
<span class="co">#&gt; 6     chr4 62474240 62474241     6 tumorA tumorA</span></code></pre></div>
</div>
<div id="default-color-scheme" class="section level4">
<h4 class="hasAnchor">
<a href="#default-color-scheme" class="anchor"></a>Default color scheme</h4>
<p>For base and amino acid annotation, we have following default color schemes, you can change with <code>nuc.color</code> and <code>aa.color</code> parameters.</p>
<p>Default color scheme for base annotation is <code>Clustal-style</code>, more popular color schemes is available <a href="https://www.biostars.org/p/171056/">here</a>.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># color scheme</span>
<span class="va">nuc.color</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span> <span class="op">=</span> <span class="st">"#ff2b08"</span>, <span class="st">"C"</span> <span class="op">=</span> <span class="st">"#009aff"</span>, <span class="st">"G"</span> <span class="op">=</span> <span class="st">"#ffb507"</span>, <span class="st">"T"</span> <span class="op">=</span> <span class="st">"#00bc0d"</span><span class="op">)</span>
<span class="co"># create plot</span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span>
  <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nuc.color</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nuc.color</span><span class="op">)</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="va">nuc.color</span>,
  xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>, bty <span class="op">=</span> <span class="st">"n"</span>
<span class="op">)</span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">nuc.color</span><span class="op">)</span>, <span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">nuc.color</span><span class="op">)</span><span class="op">)</span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>
  text <span class="op">=</span> <span class="st">"Base"</span>, adj <span class="op">=</span> <span class="fl">1</span>, las <span class="op">=</span> <span class="fl">1</span>,
  side <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-base_color_scheme-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>Default color scheme for amino acid annotation is from <a href="https://academic.oup.com/peds/article/10/7/743/1593029?login=false">Residual colours: a proposal for aminochromography</a>:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">aa.color</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span>
  <span class="st">"D"</span> <span class="op">=</span> <span class="st">"#FF0000"</span>, <span class="st">"S"</span> <span class="op">=</span> <span class="st">"#FF2400"</span>, <span class="st">"T"</span> <span class="op">=</span> <span class="st">"#E34234"</span>, <span class="st">"G"</span> <span class="op">=</span> <span class="st">"#FF8000"</span>, <span class="st">"P"</span> <span class="op">=</span> <span class="st">"#F28500"</span>,
  <span class="st">"C"</span> <span class="op">=</span> <span class="st">"#FFFF00"</span>, <span class="st">"A"</span> <span class="op">=</span> <span class="st">"#FDFF00"</span>, <span class="st">"V"</span> <span class="op">=</span> <span class="st">"#E3FF00"</span>, <span class="st">"I"</span> <span class="op">=</span> <span class="st">"#C0FF00"</span>, <span class="st">"L"</span> <span class="op">=</span> <span class="st">"#89318C"</span>,
  <span class="st">"M"</span> <span class="op">=</span> <span class="st">"#00FF00"</span>, <span class="st">"F"</span> <span class="op">=</span> <span class="st">"#50C878"</span>, <span class="st">"Y"</span> <span class="op">=</span> <span class="st">"#30D5C8"</span>, <span class="st">"W"</span> <span class="op">=</span> <span class="st">"#00FFFF"</span>, <span class="st">"H"</span> <span class="op">=</span> <span class="st">"#0F2CB3"</span>,
  <span class="st">"R"</span> <span class="op">=</span> <span class="st">"#0000FF"</span>, <span class="st">"K"</span> <span class="op">=</span> <span class="st">"#4b0082"</span>, <span class="st">"N"</span> <span class="op">=</span> <span class="st">"#800080"</span>, <span class="st">"Q"</span> <span class="op">=</span> <span class="st">"#FF00FF"</span>, <span class="st">"E"</span> <span class="op">=</span> <span class="st">"#8F00FF"</span>,
  <span class="st">"*"</span> <span class="op">=</span> <span class="st">"#FFC0CB"</span>, <span class="st">" "</span> <span class="op">=</span> <span class="st">"#FFFFFF"</span>, <span class="st">" "</span> <span class="op">=</span> <span class="st">"#FFFFFF"</span>, <span class="st">" "</span> <span class="op">=</span> <span class="st">"#FFFFFF"</span>, <span class="st">" "</span> <span class="op">=</span> <span class="st">"#FFFFFF"</span>
<span class="op">)</span>

<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">5</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/image.html">image</a></span><span class="op">(</span>
  <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, <span class="fu"><a href="https://rdrr.io/r/base/matrix.html">matrix</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">aa.color</span><span class="op">)</span>,nrow<span class="op">=</span><span class="fl">5</span><span class="op">)</span>,
  col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">aa.color</span><span class="op">)</span>,
  xlab <span class="op">=</span> <span class="st">""</span>, ylab <span class="op">=</span> <span class="st">""</span>, xaxt <span class="op">=</span> <span class="st">"n"</span>, yaxt <span class="op">=</span> <span class="st">"n"</span>, bty <span class="op">=</span> <span class="st">"n"</span>
<span class="op">)</span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/text.html">text</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/expand.grid.html">expand.grid</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>,<span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/rev.html">rev</a></span><span class="op">(</span><span class="va">aa.color</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="fu">graphics</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/graphics/mtext.html">mtext</a></span><span class="op">(</span>
  text <span class="op">=</span> <span class="st">"Amino acids"</span>, adj <span class="op">=</span> <span class="fl">1</span>, las <span class="op">=</span> <span class="fl">1</span>,
  side <span class="op">=</span> <span class="fl">2</span>
<span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-aa_color_scheme-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="add-base-and-amino-acid-annotation" class="section level4">
<h4 class="hasAnchor">
<a href="#add-base-and-amino-acid-annotation" class="anchor"></a>Add base and amino acid annotation</h4>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/ggcoverage.html">ggcoverage</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">track.df</span>, color <span class="op">=</span> <span class="st">"grey"</span>, range.position <span class="op">=</span> <span class="st">"out"</span>, single.nuc<span class="op">=</span><span class="cn">T</span>, rect.color <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_base.html">geom_base</a></span><span class="op">(</span>bam.file <span class="op">=</span> <span class="va">bam.file</span>,
            bs.fa.seq <span class="op">=</span> <span class="va">BSgenome.Hsapiens.UCSC.hg19</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_ideogram.html">geom_ideogram</a></span><span class="op">(</span>genome <span class="op">=</span> <span class="st">"hg19"</span>,plot.space <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Loading ideogram...</span>
<span class="co">#&gt; Loading ranges...</span>
<span class="co">#&gt; Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="co">#&gt; replace the existing scale.</span></code></pre></div>
<p><img src="reference/figures/README-base_aa_coverage-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
<div id="chip-seq-data" class="section level2">
<h2 class="hasAnchor">
<a href="#chip-seq-data" class="anchor"></a>ChIP-seq data</h2>
<p>The ChIP-seq data used here are from <a href="https://bioconductor.org/packages/release/bioc/html/DiffBind.html">DiffBind</a>, I select four sample to use as example: Chr18_MCF7_input, Chr18_MCF7_ER_1, Chr18_MCF7_ER_3, Chr18_MCF7_ER_2, and all bam files are converted to bigwig file with <a href="https://deeptools.readthedocs.io/en/develop/">deeptools</a>.</p>
<p>Create metadata:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># load metadata</span>
<span class="va">sample.meta</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>SampleName<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">'Chr18_MCF7_ER_1'</span>,<span class="st">'Chr18_MCF7_ER_2'</span>,<span class="st">'Chr18_MCF7_ER_3'</span>,<span class="st">'Chr18_MCF7_input'</span><span class="op">)</span>,
                         Type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"MCF7_ER_1"</span>,<span class="st">"MCF7_ER_2"</span>,<span class="st">"MCF7_ER_3"</span>,<span class="st">"MCF7_input"</span><span class="op">)</span>,
                         Group <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"IP"</span>, <span class="st">"IP"</span>, <span class="st">"IP"</span>, <span class="st">"Input"</span><span class="op">)</span><span class="op">)</span>
<span class="va">sample.meta</span>
<span class="co">#&gt;         SampleName       Type Group</span>
<span class="co">#&gt; 1  Chr18_MCF7_ER_1  MCF7_ER_1    IP</span>
<span class="co">#&gt; 2  Chr18_MCF7_ER_2  MCF7_ER_2    IP</span>
<span class="co">#&gt; 3  Chr18_MCF7_ER_3  MCF7_ER_3    IP</span>
<span class="co">#&gt; 4 Chr18_MCF7_input MCF7_input Input</span></code></pre></div>
<p>Load track files:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># track folder</span>
<span class="va">track.folder</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ChIP-seq"</span>, package <span class="op">=</span> <span class="st">"ggcoverage"</span><span class="op">)</span>
<span class="co"># load bigwig file</span>
<span class="va">track.df</span> <span class="op">=</span> <span class="fu"><a href="reference/LoadTrackFile.html">LoadTrackFile</a></span><span class="op">(</span>track.folder <span class="op">=</span> <span class="va">track.folder</span>, format <span class="op">=</span> <span class="st">"bw"</span>,
                         meta.info <span class="op">=</span> <span class="va">sample.meta</span><span class="op">)</span>
<span class="co"># check data</span>
<span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">track.df</span><span class="op">)</span>
<span class="co">#&gt;   seqnames    start      end   score      Type Group</span>
<span class="co">#&gt; 1    chr18 76799701 76800000 439.316 MCF7_ER_1    IP</span>
<span class="co">#&gt; 2    chr18 76800001 76800300 658.974 MCF7_ER_1    IP</span>
<span class="co">#&gt; 3    chr18 76800301 76800600 219.658 MCF7_ER_1    IP</span>
<span class="co">#&gt; 4    chr18 76800601 76800900 658.974 MCF7_ER_1    IP</span>
<span class="co">#&gt; 5    chr18 76800901 76801200   0.000 MCF7_ER_1    IP</span>
<span class="co">#&gt; 6    chr18 76801201 76801500 219.658 MCF7_ER_1    IP</span></code></pre></div>
<p>Prepare mark region:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># create mark region</span>
<span class="va">mark.region</span><span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>start<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">76822533</span><span class="op">)</span>,
                       end<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">76823743</span><span class="op">)</span>,
                       label<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Promoter"</span><span class="op">)</span><span class="op">)</span>
<span class="co"># check data</span>
<span class="va">mark.region</span>
<span class="co">#&gt;      start      end    label</span>
<span class="co">#&gt; 1 76822533 76823743 Promoter</span></code></pre></div>
<div id="basic-coverage-2" class="section level3">
<h3 class="hasAnchor">
<a href="#basic-coverage-2" class="anchor"></a>Basic coverage</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">basic.coverage</span> <span class="op">=</span> <span class="fu"><a href="reference/ggcoverage.html">ggcoverage</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">track.df</span>, color <span class="op">=</span> <span class="st">"auto"</span>, region <span class="op">=</span> <span class="st">"chr18:76822285-76900000"</span>, 
                            mark.region<span class="op">=</span><span class="va">mark.region</span>, show.mark.label <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>
<span class="va">basic.coverage</span></code></pre></div>
<p><img src="reference/figures/README-basic_coverage_chip-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
<div id="add-annotations" class="section level3">
<h3 class="hasAnchor">
<a href="#add-annotations" class="anchor"></a>Add annotations</h3>
<p>Add <strong>gene</strong>, <strong>ideogram</strong> and <strong>peak</strong> annotations. To create peak annotation, we first <strong>get consensus peaks</strong> with <a href="https://github.com/Genometric/MSPC">MSPC</a>, you can also use DEbChIP’s <code>GetConsensusPeak</code> (<code>MSPC</code>’s wrapper) to do this.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># get consensus peak file</span>
<span class="va">peak.file</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html">system.file</a></span><span class="op">(</span><span class="st">"extdata"</span>, <span class="st">"ChIP-seq"</span>, <span class="st">"consensus.peak"</span>, package <span class="op">=</span> <span class="st">"ggcoverage"</span><span class="op">)</span>

<span class="va">basic.coverage</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_gene.html">geom_gene</a></span><span class="op">(</span>gtf.gr<span class="op">=</span><span class="va">gtf.gr</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_peak.html">geom_peak</a></span><span class="op">(</span>bed.file <span class="op">=</span> <span class="va">peak.file</span><span class="op">)</span> <span class="op">+</span>
  <span class="fu"><a href="reference/geom_ideogram.html">geom_ideogram</a></span><span class="op">(</span>genome <span class="op">=</span> <span class="st">"hg19"</span>,plot.space <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="co">#&gt; Loading ideogram...</span>
<span class="co">#&gt; Loading ranges...</span>
<span class="co">#&gt; Scale for 'x' is already present. Adding another scale for 'x', which will</span>
<span class="co">#&gt; replace the existing scale.</span></code></pre></div>
<p><img src="reference/figures/README-peak_coverage-1.png" width="100%" style="display: block; margin: auto;"></p>
</div>
</div>
<div id="code-of-conduct" class="section level2">
<h2 class="hasAnchor">
<a href="#code-of-conduct" class="anchor"></a>Code of Conduct</h2>
<p>Please note that the <code>ggcoverage</code> project is released with a <a href="https://contributor-covenant.org/version/2/0/CODE_OF_CONDUCT.html">Contributor Code of Conduct</a>. By contributing to this project, you agree to abide by its terms.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=ggcoverage">https://​cloud.r-project.org/​package=ggcoverage</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CODE_OF_CONDUCT.html">Code of conduct</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Yabing Song <br><small class="roles"> Author, maintainer </small>  </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Yabing Song.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
